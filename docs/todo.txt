SPQR Hacking Guide

SPQR Startup.
	Init the GUI 
		Init Screen 
		Load and convert all graphics 
		Load all fonts 
		Set various resolution independant variables 
	Setup the units 
		Allocate space and structure 
	Call main init() function 
		Define the menu and build it 
		Draws the box below the map (defined as a window) 
		Add the test buttons 
		Add some simple units 
	Draw everything 
	Call the main loop (lgui.main_loop()) 
	Inside the main loop:
		Loop until event reached: 
		Check map scroll first 
		Check against all possible events 
		test_mouse() is the function that gets called after determining what 
			event we got. It checks the following:

			Goes through each defined window in reverse order of definition.
			If a modal window, only checks that
			Is the mouse inside the window?
				Yes: check against that window
				Finally, call the widget itself.

First:
Sort out the module mess.
*DONE*

Each module must be self contained and ONLY define things. If it needs a callback
to data then it should from a central point.
*DONE*

The gui functions need to be called from most things, so:
Say in SPQR_WIDGET it needs lgui. Each widget must have a local pointer to lgui, and so on.
*DONE*

LGUI DRAWS EVERYTHING AND HOLDS ALL THE GFX, BUT NO GAME DATA
*DONE*

Things to do/improve on:

Click on hex also checks unit and displays it
*DONE*
Only allow map panning above the map itself
*DONE*
Map co-ords actually work (lots of fussy debugging)
*DONE* (although not FULLY tested, I know the routs work fine.. maybe a few hexes
	may be wrong but these will be tested when I have movement coded (it will be easier)
Make detection of hex clicking pixel perfect
*DONE*
Make the menus look better (more space, icons, shortcuts)
*DONE*
Add keyboard detection in events, and add some keyboard shortcuts for the menus
*DONE*
Allow click dragging on mini-map
Implement a game turn by:
showing date/game turn
*DONE*
flash unit to move 
*DONE*
allow one-hex movement 
go through each unit after the move 
show 'end turn' button at end of turn
*DONE*

SPQR should be built around the city.

Each city has a number of hexes around it that it 'controls'. If you capture a city and hold it for a length of time, then those hexes become yours.
Hexes can be changed between cities if one grows or weakens.
In areas where there are no major cities then you need a miltary presence, followed by a perhaps founding such a city.
In fact, instead of the map, one should think of a nodal network when one thinks of the map of SPQR.

SPQR is modelled in the following way:

It starts fairly easy, and gets harder. Reasons:

Military starts as Citizen-soldiers, becomes a recruited force (we start at 200BC, remember).
Italy starts as a producer of money, but soon becomes a consumer.
The more control you exert in areas, the harder it becomes, because you are not nessacerily the best one to choose.
Religion starts to change the people.
Barbarians become more like you, and better at being like you.

GFX Notes:
All units and cities must be the same size!

TODO Latest: (3/3/06)

Make the next button float around all the units
*DONE*
Make widgets non-active by default
*DONE*
Add kbd stack and use it
*DONE*
Make hex detection pixel perfect, or even better, just working properly :-s
*DONE*
Make the menus work a bit better and look much better
*DONE*
*This should be version 0.2, so go and erase some TODO's*
MAKE THE CURRENT UNIT FLASH
*DONE*
Make buttons light up whilst over them
*DONE*
Parse command line options
*DONE*
Add startup window
*DONE*
Make the messagebox use a dirty rect
*DONE*
Make all windows use a dirty rect, and update the screen this way
*DONE*
Check bug for Carthago Nova city info display
*DONE*
Hex checking is still not pixel perfect (close, but still some bugs)
*DONE*
Allow units to move 1 hex per turn, then the turn ends
*DONE*
Fix window creation border size and offsets
Show movement left for unit when highlighted
Amend keys at end turn
*DONE*
Add 1 more key: f - move finished
*DONE*
Add some unit details to the parser and game:
*DONE*
*This should be version 0.3, so go and erase some TODO's*
Add roads to the gfx engine (and the parser, of course)
*BY SUNDAY 19th MARCH*
Add city ownership to parser
Color in hexes according to ownership
Allow capture of cities
*BY SUNDAY 26th MARCH*
*This is 0.4, go over the code again*
Allow battles between meeting units
Allow ports and thus navies with sea movement
*BY THURSDAY 30th MARCH*
Add an economic cycle, and the screens for it
*This should be looking like a playable game, and is version 0.5*
Build some AI into the system, so it can play you
*This is version 0.6, and you can really start to push it*
